import"../chunks/DsnmJJEf.js";import"../chunks/luk3gl1z.js";import{o as ne}from"../chunks/_gNL4IXV.js";import{p as de,f as b,b as d,c as ce,s as o,d as i,e,m as c,g as s,n as T,r as l,w as F,a as J,t as O,v as W}from"../chunks/CwLoShKX.js";import{s as me,e as pe}from"../chunks/D8bngpjW.js";import{i as E}from"../chunks/WMMc_YU6.js";import{r as N,b as ue}from"../chunks/CkmYFb5S.js";import{b as U}from"../chunks/DGOQ8hUW.js";import{p as fe}from"../chunks/CdEA5IGF.js";import{i as ve}from"../chunks/Ccxz8Bhd.js";import{t as X,a as xe}from"../chunks/wZ8Uf4_x.js";var be=b('<div class="space-y-3"><div class="h-4 w-40 rounded bg-slate-200 animate-pulse"></div> <div class="h-10 w-full rounded-xl bg-slate-200 animate-pulse"></div> <div class="h-10 w-full rounded-xl bg-slate-200 animate-pulse"></div> <div class="h-10 w-full rounded-xl bg-slate-200 animate-pulse"></div></div>'),ge=b('<div class="rounded-xl border border-rose-100 bg-rose-50 px-4 py-3 text-sm text-rose-700"> </div>'),_e=b('<p class="text-sm text-slate-600">No se pudo obtener la información de tu perfil. Intenta recargar la página.</p>'),he=b(`<form class="rounded-2xl border border-slate-200 bg-white shadow-sm p-4 sm:p-6 space-y-5"><div class="grid gap-4 sm:grid-cols-2"><div class="sm:col-span-2"><p class="text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1.5">Información de la cuenta</p> <p class="text-xs text-slate-500">Estos datos se usan para identificar tu usuario y contactarte.</p></div> <div class="space-y-1"><label for="username" class="text-xs font-medium text-slate-700">Usuario</label> <input id="username" type="text" class="w-full rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-sm text-slate-500" disabled/> <p class="text-[11px] text-slate-400">El nombre de usuario no se puede cambiar.</p></div> <div class="space-y-1"><label for="email" class="text-xs font-medium text-slate-700">Correo electrónico</label> <input id="email" type="email" required class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/80"/> <p class="text-[11px] text-slate-400">A este correo llegarán confirmaciones y comunicaciones.</p></div> <div class="space-y-1"><label for="first_name" class="text-xs font-medium text-slate-700">Nombre</label> <input id="first_name" type="text" class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/80"/></div> <div class="space-y-1"><label for="last_name" class="text-xs font-medium text-slate-700">Apellidos</label> <input id="last_name" type="text" class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/80"/></div></div> <div class="flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 pt-2 border-t border-slate-100 mt-2"><p class="text-xs text-slate-500 max-w-sm">Si necesitas cambiar datos más avanzados de tu cuenta, puedes contactar directamente a
          Cocinas Appel.</p> <button type="submit" class="inline-flex items-center justify-center gap-2 rounded-xl bg-amber-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-amber-700 disabled:opacity-60"><!></button></div></form>`),ye=b('<section class="max-w-3xl mx-auto space-y-6"><header class="space-y-1"><h1 class="text-2xl sm:text-3xl font-semibold text-slate-900 tracking-tight">Mi perfil</h1> <p class="text-slate-600 text-sm sm:text-base">Revisa y actualiza tus datos personales de tu cuenta en Cocinas Appel.</p></header> <!> <div class="pt-2"><a href="/mi-cuenta/pedidos" class="inline-flex items-center gap-1.5 text-xs font-medium text-slate-600 hover:text-slate-900"><svg viewBox="0 0 24 24" class="h-3.5 w-3.5" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M5 12h14M5 12l4-4M5 12l4 4" stroke-linecap="round" stroke-linejoin="round"></path></svg> Volver a mis pedidos</a></div></section>');function ze(H,K){de(K,!1);const g="https://tienda-backend-rodrigo.azurewebsites.net".replace(/\/+$/,"")??"";function Q(){return typeof document>"u"?"":document.cookie.split("; ").find(t=>t.startsWith("csrftoken="))?.split("=")[1]??""}let _=c(!0),h=c(!1),n=c(""),v=c(null),y=c(""),w=c(""),k=c("");ne(Y);async function Y(){if(!g){e(n,"No está configurada la URL de la API (VITE_API_URL)."),e(_,!1);return}e(_,!0),e(n,"");try{const t=await fetch(`${g}/api/me/profile/`,{credentials:"include"});if(!t.ok){const x=await t.text();throw new Error(x||`Error ${t.status}`)}const a=await t.json();e(v,a),e(y,a.first_name??""),e(w,a.last_name??""),e(k,a.email??"")}catch(t){e(n,t?.message||"No se pudo cargar el perfil."),X(s(n))}finally{e(_,!1)}}async function Z(t){if(t.preventDefault(),!(!s(v)||!g)){e(h,!0),e(n,"");try{const a=await fetch(`${g}/api/me/profile/`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":Q()},body:JSON.stringify({first_name:s(y),last_name:s(w),email:s(k)})});if(!a.ok){const j=await a.text();throw new Error(j||`Error ${a.status}`)}const x=await a.json();e(v,x),xe("Perfil actualizado correctamente.")}catch(a){e(n,a?.message||"No se pudo guardar el perfil."),X(s(n))}finally{e(h,!1)}}}ve();var A=ye(),$=o(i(A),2);{var ee=t=>{var a=be();d(t,a)},te=t=>{var a=F(),x=J(a);{var j=m=>{var p=ge(),C=i(p,!0);l(p),O(()=>me(C,s(n))),d(m,p)},ae=m=>{var p=F(),C=J(p);{var se=u=>{var f=_e();d(u,f)},re=u=>{var f=he(),I=i(f),P=o(i(I),2),D=o(i(P),2);N(D),T(2),l(P);var M=o(P,2),G=o(i(M),2);N(G),T(2),l(M);var S=o(M,2),L=o(i(S),2);N(L),l(S);var V=o(S,2),q=o(i(V),2);N(q),l(V),l(I);var B=o(I,2),z=o(i(B),2),oe=i(z);{var ie=r=>{var R=W("Guardando…");d(r,R)},le=r=>{var R=W("Guardar cambios");d(r,R)};E(oe,r=>{s(h)?r(ie):r(le,!1)})}l(z),l(B),l(f),O(()=>{ue(D,s(v).username),z.disabled=s(h)}),U(G,()=>s(k),r=>e(k,r)),U(L,()=>s(y),r=>e(y,r)),U(q,()=>s(w),r=>e(w,r)),pe("submit",f,fe(Z)),d(u,f)};E(C,u=>{s(v)?u(re,!1):u(se)},!0)}d(m,p)};E(x,m=>{s(n)?m(j):m(ae,!1)},!0)}d(t,a)};E($,t=>{s(_)?t(ee):t(te,!1)})}T(2),l(A),d(H,A),ce()}export{ze as component};
