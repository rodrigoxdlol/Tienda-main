import"../chunks/DsnmJJEf.js";import"../chunks/luk3gl1z.js";import{o as ha}from"../chunks/_gNL4IXV.js";import{p as _a,o as Te,q as ya,f as x,s as n,t as P,g as e,b as p,c as wa,d as o,e as c,m as v,r,n as R,u,h as T,v as me,w as ka,a as Sa,x as ge}from"../chunks/CwLoShKX.js";import{e as y,s as J}from"../chunks/D8bngpjW.js";import{i as f}from"../chunks/WMMc_YU6.js";import{e as De,i as ja}from"../chunks/ThBeqclG.js";import{r as M,s as be,a as Ca}from"../chunks/CkmYFb5S.js";import{b as G}from"../chunks/DGOQ8hUW.js";import{i as Ma}from"../chunks/Ccxz8Bhd.js";import{a as Ga,b as Ia,c as La,d as Ee,e as Ba}from"../chunks/Q6rjOpry.js";import{t as w,a as fe}from"../chunks/wZ8Uf4_x.js";var Oa=T('<svg class="h-3.5 w-3.5 animate-spin" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-opacity=".25" stroke-width="3"></circle><path d="M21 12a9 9 0 0 1-9 9" stroke="currentColor" stroke-width="3" stroke-linecap="round"></path></svg> Cargando…',1),Pa=T('<svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none"><path d="M5 12a7 7 0 0 1 11.95-4.95L19 4m-1 5v-4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path><path d="M19 12a7 7 0 0 1-11.95 4.95L5 20m1-5v4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path></svg> Actualizar',1),Ra=x('<div class="mt-3 flex items-center gap-3"><img alt="preview" class="h-14 w-14 rounded-lg object-cover ring-1 ring-slate-200"/> <button type="button" class="text-[11px] text-rose-600 hover:underline">Quitar imagen</button></div>'),Ta=T('<svg class="h-4 w-4 animate-spin" viewBox="0 0 24 24" fill="none"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 0 1 8-8v3a5 5 0 0 0-5 5H4z"></path></svg> Subiendo…',1),Da=x('<div class="rounded-2xl border border-slate-200 bg-white p-4 space-y-3"><div class="h-40 rounded-xl bg-slate-100 animate-pulse"></div> <div class="h-3 rounded bg-slate-100 animate-pulse"></div> <div class="h-3 rounded bg-slate-100 animate-pulse w-2/3"></div></div>'),Ea=x('<div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3"></div>'),Fa=x('<div class="rounded-2xl border border-dashed border-slate-300 bg-slate-50/60 px-4 py-10 text-center text-sm text-slate-500">Aún no has agregado imágenes a la galería. Sube una imagen con el formulario superior para comenzar.</div>'),Ua=x('<span class="inline-flex items-center gap-1 rounded-full bg-slate-900/85 px-2 py-0.5 text-[11px] text-white">Inactiva</span>'),za=T('<svg class="h-3.5 w-3.5 animate-spin text-slate-500" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-opacity=".25" stroke-width="3"></circle><path d="M21 12a9 9 0 0 1-9 9" stroke="currentColor" stroke-width="3" stroke-linecap="round"></path></svg>'),Aa=x('<p class="text-[11px] text-slate-500">Guardando cambios…</p>'),Na=x(`<div class="group rounded-2xl border border-slate-200 bg-white overflow-hidden shadow-sm hover:shadow-md transition"><div class="relative h-44 bg-slate-100"><img class="absolute inset-0 h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.02]"/> <div class="absolute top-2 left-2 flex flex-col gap-1"><span class="inline-flex items-center gap-1 rounded-full bg-white/90 px-2 py-0.5 text-[11px] font-medium text-slate-700 ring-1 ring-slate-200"><span class="h-1.5 w-1.5 rounded-full bg-amber-500"></span> <span> </span></span> <!></div></div> <div class="p-4 space-y-3"><label class="block"><span class="block text-xs text-slate-600 mb-1">Título</span> <input class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/70" placeholder="Título"/></label> <label class="block"><span class="block text-xs text-slate-600 mb-1">Descripción</span> <input class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/70" placeholder="Descripción"/></label> <div class="flex items-center justify-between gap-3"><label class="inline-flex items-center gap-2 select-none text-xs text-slate-700 cursor-pointer"><input type="checkbox" class="peer sr-only"/> <span class="relative inline-flex h-5 w-9 items-center rounded-full ring-1 ring-slate-300
                           bg-slate-300 peer-checked:bg-emerald-600 peer-checked:ring-emerald-500/40
                           transition-colors duration-300 disabled:opacity-60"><span class="absolute left-1 h-3.5 w-3.5 rounded-full bg-white shadow-sm transform-gpu
                             transition-transform duration-300 peer-checked:translate-x-4"></span></span> <!></label> <div class="flex items-center gap-2"><input class="w-20 rounded-xl border border-slate-300 px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/70" type="number" title="Orden"/> <button type="button" class="rounded-lg bg-rose-600 text-white px-3 py-1.5 text-xs font-medium hover:bg-rose-700 disabled:opacity-60"> </button></div></div> <!></div></div>`),qa=x('<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-5"></div>'),Ha=T('<svg class="h-4 w-4 animate-spin" viewBox="0 0 24 24" fill="none"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 0 1 8-8v3a5 5 0 0 0-5 5H4z"></path></svg> Guardando…',1),Ja=x('<div class="mt-6 flex justify-end"><button type="button" class="inline-flex items-center gap-2 rounded-xl bg-slate-900 text-white px-4 py-2 text-sm font-medium shadow hover:bg-slate-800 disabled:opacity-60"><!></button></div>'),Qa=x('<section class="mx-auto max-w-7xl px-4 py-6 space-y-6"><header class="flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"><div class="space-y-1"><h1 class="text-2xl sm:text-3xl font-semibold text-slate-900 tracking-tight">Imágenes de galería</h1> <p class="text-slate-600 text-sm sm:text-base">Gestiona las imágenes de la sección de galería: títulos, descripciones, orden y estado.</p></div> <div class="flex flex-col items-start sm:items-end gap-1 text-xs text-slate-500"><span class="inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1"><span class="h-1.5 w-1.5 rounded-full bg-emerald-500"></span> <span> </span></span> <button type="button" class="mt-1 inline-flex items-center gap-2 rounded-xl bg-slate-900 text-white px-3 py-1.5 text-xs font-medium shadow hover:bg-black disabled:opacity-60"><!></button></div></header> <div class="rounded-2xl border border-slate-200 bg-white p-4 sm:p-5 shadow-sm"><h2 class="text-sm font-semibold text-slate-900 mb-1">Nueva imagen para la galería</h2> <p class="text-[11px] text-slate-500 mb-4">Sube una imagen y define el texto que se mostrará junto a ella.</p> <div class="grid sm:grid-cols-5 gap-3 items-start"><div class="sm:col-span-2"><span class="block text-xs text-slate-600 mb-1">Imagen</span> <label class="inline-flex items-center gap-2 rounded-xl border border-dashed border-slate-300 bg-slate-50 px-3 py-2 text-xs text-slate-700 cursor-pointer hover:bg-slate-100"><span class="inline-flex h-6 w-6 items-center justify-center rounded-full bg-slate-900 text-white"><svg class="h-3 w-3" viewBox="0 0 24 24" fill="none"><path d="M12 5v14m0-14L8 9m4-4 4 4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path></svg></span> <span>Seleccionar archivo</span> <input type="file" accept="image/*" class="sr-only"/></label> <p class="mt-1 text-[11px] text-slate-400"></p> <!></div> <label><span class="block text-xs text-slate-600 mb-1">Título</span> <input class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/70" placeholder="Ej: Foto del taller"/></label> <label><span class="block text-xs text-slate-600 mb-1">Descripción</span> <input class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/70" placeholder="Texto breve bajo el título"/></label> <label><span class="block text-xs text-slate-600 mb-1">Orden</span> <input class="w-full rounded-xl border border-slate-300 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/70" type="number" min="0"/> <p class="mt-1 text-[11px] text-slate-400">Menor número → aparece primero.</p></label></div> <div class="mt-4 flex justify-end"><button type="button" class="inline-flex items-center gap-2 rounded-xl bg-amber-600 text-white px-4 py-2 text-sm font-medium shadow hover:bg-amber-700 disabled:opacity-60"><!></button></div></div> <div class="space-y-4"><!></div> <!></section>');function nt(Fe,Ue){_a(Ue,!1);const xe=v(),he=v();let d=v([]),I=v(!0),D=null,k=v(null),E=v(""),F=v(""),U=v(0),z=v(!1),h=v(new Set),j=v(new Set),_=v(new Set),A=v(!1);const _e=10;ha(L);async function L(){c(I,!0);try{const a=await Ga();c(d,(a||[]).map(t=>({...t,title:t.title??"",caption:t.caption??"",order:Number.isFinite(t.order)?t.order:0})))}catch(a){w(String(a?.message??a))}finally{c(I,!1)}}function ze(a){if(!/^image\//.test(a.type)){w("El archivo debe ser una imagen");return}if(a.size>_e*1024*1024){w(`Máximo ${_e} MB`);return}D=a,e(k)&&URL.revokeObjectURL(e(k)),c(k,URL.createObjectURL(a))}function Ae(a){const t=a.target,s=t.files?.[0];s&&(ze(s),t.value="")}function ye(){D=null,e(k)&&URL.revokeObjectURL(e(k)),c(k,null)}async function Ne(){if(!D){w("Selecciona una imagen");return}c(z,!0);try{await Ia({file:D,title:e(E),caption:e(F),order:e(U)}),fe("Imagen subida"),ye(),c(E,""),c(F,""),c(U,0),await L()}catch(a){w(String(a?.message??a))}finally{c(z,!1)}}async function qe(a){const t=a.id,s=a.is_active;Q(t,{is_active:!s}),c(h,new Set(e(h)).add(t));try{await Ee(t,{is_active:!s})}catch(g){Q(t,{is_active:s}),w(String(g?.message??g))}finally{e(h).delete(t),c(h,new Set(e(h)))}}function He(a,t=600){let s=null;return(...g)=>{s&&clearTimeout(s),s=setTimeout(()=>a(...g),t)}}const Je=He(async(a,t)=>{c(j,new Set(e(j)).add(a));try{await Ee(a,t)}catch(s){w(String(s?.message??s)),await L()}finally{e(j).delete(a),c(j,new Set(e(j)))}},500);function we(a,t,s){Q(a,{[t]:s}),Je(a,{[t]:s})}async function Qe(a){const t=a.id;if(confirm("¿Eliminar esta imagen de la galería?")){c(_,new Set(e(_)).add(t));try{await Ba(t),c(d,e(d).filter(s=>s.id!==t)),fe("Imagen eliminada")}catch(s){w(String(s?.message??s))}finally{e(_).delete(t),c(_,new Set(e(_)))}}}async function Xe(){if(e(d).length){c(A,!0);try{const a=e(d).map((t,s)=>({id:t.id,order:Number.isFinite(t.order)?Number(t.order):s}));await La(a),fe("Orden guardado"),await L()}catch(a){w(String(a?.message??a))}finally{c(A,!1)}}}function Q(a,t){c(d,e(d).map(s=>s.id===a?{...s,...t}:s))}Te(()=>e(d),()=>{c(xe,e(d).length)}),Te(()=>e(d),()=>{c(he,e(d).filter(a=>a.is_active).length)}),ya(),Ma();var X=Qa(),K=o(X),ke=n(o(K),2),V=o(ke),Se=n(o(V),2),Ke=o(Se);r(Se),r(V);var N=n(V,2),Ve=o(N);{var We=a=>{var t=Oa();R(),p(a,t)},Ye=a=>{var t=Pa();R(),p(a,t)};f(Ve,a=>{e(I)?a(We):a(Ye,!1)})}r(N),r(ke),r(K);var W=n(K,2),Y=n(o(W),4),Z=o(Y),$=n(o(Z),2),Ze=n(o($),4);r($);var je=n($,2);je.textContent="Formatos recomendados: JPG o PNG. Peso máximo ~10 MB.";var $e=n(je,2);{var ea=a=>{var t=Ra(),s=o(t),g=n(s,2);r(t),P(()=>be(s,"src",e(k))),y("click",g,ye),p(a,t)};f($e,a=>{e(k)&&a(ea)})}r(Z);var ee=n(Z,2),Ce=n(o(ee),2);M(Ce),r(ee);var ae=n(ee,2),Me=n(o(ae),2);M(Me),r(ae);var Ge=n(ae,2),Ie=n(o(Ge),2);M(Ie),R(2),r(Ge),r(Y);var Le=n(Y,2),q=o(Le),aa=o(q);{var ta=a=>{var t=Ta();R(),p(a,t)},sa=a=>{var t=me("Guardar imagen");p(a,t)};f(aa,a=>{e(z)?a(ta):a(sa,!1)})}r(q),r(Le),r(W);var te=n(W,2),ra=o(te);{var la=a=>{var t=Ea();De(t,4,()=>Array(3),ja,(s,g)=>{var B=Da();p(s,B)}),r(t),p(a,t)},na=a=>{var t=ka(),s=Sa(t);{var g=S=>{var m=Fa();p(S,m)},B=S=>{var m=qa();De(m,5,()=>e(d),C=>C.id,(C,l,Xa)=>{var se=Na(),re=o(se),le=o(re),Be=n(le,2),ne=o(Be),Oe=n(o(ne),2),ca=o(Oe);r(Oe),r(ne);var da=n(ne,2);{var pa=i=>{var b=Ua();p(i,b)};f(da,i=>{e(l),u(()=>!e(l).is_active)&&i(pa)})}r(Be),r(re);var Pe=n(re,2),oe=o(Pe),ie=n(o(oe),2);M(ie),r(oe);var ce=n(oe,2),de=n(o(ce),2);M(de),r(ce);var pe=n(ce,2),ve=o(pe),O=o(ve);M(O);var va=n(O,4);{var ua=i=>{var b=za();p(i,b)},ma=i=>{var b=me();P(()=>J(b,(e(l),u(()=>e(l).is_active?"activo":"inactivo")))),p(i,b)};f(va,i=>{e(h),e(l),u(()=>e(h).has(e(l).id))?i(ua):i(ma,!1)})}r(ve);var Re=n(ve,2),ue=o(Re);M(ue);var H=n(ue,2),ga=o(H,!0);r(H),r(Re),r(pe);var ba=n(pe,2);{var fa=i=>{var b=Aa();p(i,b)};f(ba,i=>{e(j),e(l),u(()=>e(j).has(e(l).id))&&i(fa)})}r(Pe),r(se),P((i,b,xa)=>{be(le,"src",(e(l),u(()=>e(l).image))),be(le,"alt",(e(l),u(()=>e(l).title))),J(ca,`Orden ${e(l),u(()=>e(l).order)??""}`),Ca(O,(e(l),u(()=>e(l).is_active))),O.disabled=i,H.disabled=b,J(ga,xa)},[()=>(e(h),e(l),u(()=>e(h).has(e(l).id))),()=>(e(_),e(l),u(()=>e(_).has(e(l).id))),()=>(e(_),e(l),u(()=>e(_).has(e(l).id)?"Borrando…":"Eliminar"))]),G(ie,()=>e(l).title,i=>(e(l).title=i,ge(()=>e(d)))),y("input",ie,i=>we(e(l).id,"title",i.target.value)),G(de,()=>e(l).caption,i=>(e(l).caption=i,ge(()=>e(d)))),y("input",de,i=>we(e(l).id,"caption",i.target.value)),y("change",O,()=>qe(e(l))),G(ue,()=>e(l).order,i=>(e(l).order=i,ge(()=>e(d)))),y("click",H,()=>Qe(e(l))),p(C,se)}),r(m),p(S,m)};f(s,S=>{e(d),u(()=>!e(d).length)?S(g):S(B,!1)},!0)}p(a,t)};f(ra,a=>{e(I)?a(la):a(na,!1)})}r(te);var oa=n(te,2);{var ia=a=>{var t=Ja(),s=o(t),g=o(s);{var B=m=>{var C=Ha();R(),p(m,C)},S=m=>{var C=me("Guardar orden");p(m,C)};f(g,m=>{e(A)?m(B):m(S,!1)})}r(s),r(t),P(()=>s.disabled=e(A)),y("click",s,Xe),p(a,t)};f(oa,a=>{e(d),u(()=>e(d).length)&&a(ia)})}r(X),P(()=>{J(Ke,`${e(he)??""} activas de ${e(xe)??""} imágenes`),N.disabled=e(I),q.disabled=e(z)}),y("click",N,L),y("change",Ze,Ae),G(Ce,()=>e(E),a=>c(E,a)),G(Me,()=>e(F),a=>c(F,a)),G(Ie,()=>e(U),a=>c(U,a)),y("click",q,Ne),p(Fe,X),wa()}export{nt as component};
