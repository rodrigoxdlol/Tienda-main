import{d as c,w as p}from"./BH5FzZss.js";import{i as b,j as g,u as f,r as y}from"./BtBNgcIe.js";const C="/images/placeholder-product.jpg",N="https://tienda-backend-rodrigo.azurewebsites.net".replace(/\/+$/,""),i=t=>t?/^https?:\/\//i.test(t)?t:`${N}${t.startsWith("/")?"":"/"}${t}`:null,s=p(null),q=c(s,t=>t?t.items.reduce((a,e)=>a+e.qty,0):0),v=c(s,t=>t?.total??0);function h(t){const a=t?.product??{},e=i(a.image),u=i(a?.images?.[0]?.image),m=e||u||C,o=Number(t.unit_price??a.price??0),r=Number(t.qty??0),d=Number(t.subtotal??o*r),l={id:a.id,name:a.name??"Producto",price:Number(a.price??o??0),slug:a.slug??a.id,image:m};return{id:t.id,product:l,qty:r,unit_price:o,subtotal:d}}function n(t){return{id:t.id,items:(t.items??[]).map(h),total:Number(t.total??0)}}async function z(){const t=await b();s.set(n(t))}async function P(t,a=1){const e=await g(t,a);s.set(n(e.cart??e))}async function j(t,a){const e=await f(t,a);s.set(n(e.cart??e))}async function A(t){const a=await y(t);s.set(n(a.cart??a))}export{P as a,q as b,s as c,z as l,A as r,v as t,j as u};
