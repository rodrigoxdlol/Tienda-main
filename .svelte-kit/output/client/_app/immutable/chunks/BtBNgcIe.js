const u="https://tienda-backend-rodrigo.azurewebsites.net".replace(/\/+$/,"")||"";function i(t){return document.cookie.split("; ").find(n=>n.startsWith(t+"="))?.split("=")[1]??""}async function s(t){const n=await fetch(`${u}${t}`,{credentials:"include"});if(!n.ok)throw new Error(await n.text());return n.json()}async function d(t,n,e={}){const a={"Content-Type":"application/json",...e};if(!a["X-CSRFToken"])try{await r();const c=i("csrftoken");c&&(a["X-CSRFToken"]=c)}catch{}const o=await fetch(`${u}${t}`,{method:"POST",credentials:"include",headers:a,body:JSON.stringify(n)});if(!o.ok)throw new Error(await o.text());return o.json()}async function f(t,n,e={}){const a={"Content-Type":"application/json",...e};if(!a["X-CSRFToken"])try{await r();const c=i("csrftoken");c&&(a["X-CSRFToken"]=c)}catch{}const o=await fetch(`${u}${t}`,{method:"PATCH",credentials:"include",headers:a,body:JSON.stringify(n)});if(!o.ok)throw new Error(await o.text());return o.json()}async function r(){return s("/api/csrf/")}async function l(){return s("/api/auth/me/")}async function y(t,n){await r();const e=i("csrftoken");return d("/api/auth/login/",{username:t,password:n},{"X-CSRFToken":e})}async function h(){const t=i("csrftoken");return d("/api/auth/logout/",{},{"X-CSRFToken":t})}async function k(t){await r();const n=i("csrftoken");return d("/api/auth/register/",t,{"X-CSRFToken":n})}async function p(){return s("/api/products/")}async function w(t){try{const n=await s(`/api/products/${t}/`);return console.log("Producto desde endpoint individual:",n),n}catch(n){console.log("Endpoint individual fallÃ³, usando listado:",n);const a=(await p()).find(o=>o.slug===t||o.id===t||String(o.id)===String(t));if(!a)throw new Error("Product not found");return console.log("Producto desde listado:",a),a}}async function m(){return s("/api/cart/")}async function g(t,n=1){await r();const e=i("csrftoken");return d("/api/cart/items/",{product_id:t,qty:n},{"X-CSRFToken":e})}async function C(t,n){await r();const e=i("csrftoken"),a=await fetch(`${u}/api/cart/items/${t}/`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRFToken":e},body:JSON.stringify({qty:n})});if(!a.ok)throw new Error(await a.text());return a.json()}async function T(t){await r();const n=i("csrftoken"),e=await fetch(`${u}/api/cart/items/${t}/delete/`,{method:"DELETE",credentials:"include",headers:{"X-CSRFToken":n}});if(!e.ok)throw new Error(await e.text());try{return await e.json()}catch{return{ok:!0}}}async function S(){return s("/api/site/home-images/")}async function $(){return s("/api/site/gallery-images/")}async function P(){return s("/api/admin/shop/contact-messages/")}async function E(t,n){return f(`/api/admin/shop/contact-messages/${t}/`,n)}async function F(){return s("/api/shop/my/contact-messages/")}async function R(){return s("/api/admin/shop/contact-messages/stats/")}async function X(){return s("/api/site/news-images/")}export{u as A,P as a,E as b,$ as c,X as d,l as e,y as f,i as g,h,m as i,g as j,p as k,S as l,F as m,w as n,k as o,R as p,d as q,T as r,C as u};
